



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Docs for the Quarters Project">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.1.0">
    
    
      
        <title>Unity PlayFab - Quarters</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.982221ab.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.224b79ff.css">
      
      
        
        
        <meta name="theme-color" content="#546e7a">
      
    
    
      <script src="../../assets/javascripts/modernizr.01ccdecf.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="blue-grey" data-md-color-accent="indigo">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#quarters-unity-sdk-playfab-module" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../.." title="Quarters" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Quarters
            </span>
            <span class="md-header-nav__topic">
              Unity PlayFab
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/weiks/quarters-docs/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    weiks/quarters-docs
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../.." title="Quarters" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    Quarters
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/weiks/quarters-docs/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    weiks/quarters-docs
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../getting-started/" title="Getting started" class="md-nav__link">
      Getting started
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Quarters OAuth
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Quarters OAuth
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../oauth/introduction/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../oauth/integrating/" title="Integrating" class="md-nav__link">
      Integrating
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../oauth/refresh-tokens/" title="Refresh tokens" class="md-nav__link">
      Refresh tokens
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../quarters-buttons/" title="Quarters buttons" class="md-nav__link">
      Quarters buttons
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5" checked>
    
    <label class="md-nav__link" for="nav-5">
      Libraries (SDK)
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Libraries (SDK)
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../js/" title="JavaScript (client)" class="md-nav__link">
      JavaScript (client)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../node/" title="Node (server)" class="md-nav__link">
      Node (server)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../unity/" title="Unity" class="md-nav__link">
      Unity
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Unity PlayFab
      </label>
    
    <a href="./" title="Unity PlayFab" class="md-nav__link md-nav__link--active">
      Unity PlayFab
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#videos" title="Videos" class="md-nav__link">
    Videos
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prerequisites" title="Prerequisites:" class="md-nav__link">
    Prerequisites:
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installation" title="Installation:" class="md-nav__link">
    Installation:
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#awardquarters" title="AwardQuarters" class="md-nav__link">
    AwardQuarters
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../unity-playfab-iap/" title="Unity PlayFab IAP" class="md-nav__link">
      Unity PlayFab IAP
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      APIs
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        APIs
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../apis/oauth/" title="OAuth" class="md-nav__link">
      OAuth
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../apis/user/" title="Users & accounts" class="md-nav__link">
      Users & accounts
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../apis/transfer-requests/" title="Transfers" class="md-nav__link">
      Transfers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../apis/iap/" title="IAP" class="md-nav__link">
      IAP
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      Guides
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        Guides
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../guides/create-app/" title="Create App" class="md-nav__link">
      Create App
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guides/login-quarters/" title="Login with Quarters (oauth v2)" class="md-nav__link">
      Login with Quarters (oauth v2)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guides/transfer-quarters/" title="Transfer quarters" class="md-nav__link">
      Transfer quarters
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#videos" title="Videos" class="md-nav__link">
    Videos
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prerequisites" title="Prerequisites:" class="md-nav__link">
    Prerequisites:
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installation" title="Installation:" class="md-nav__link">
    Installation:
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#awardquarters" title="AwardQuarters" class="md-nav__link">
    AwardQuarters
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/weiks/quarters-docs/edit/master/docs/sdk/unity-playfab.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="quarters-unity-sdk-playfab-module">Quarters Unity SDK - PlayFab Module</h1>
<p>PlayFab Module allows transferring quarters from the Quarters app to the users through PlayFab cloud script.
This allows custom logic to be injected to the PlayFab server to verify if transfer request can be authorized.</p>
<p>» <strong><a href="http://downloads.pocketfulofquarters.com/quarters-sdk-latest.unitypackage">Download Quarters Unity SDK.</a></strong></p>
<h2 id="videos">Videos</h2>
<p>Make sure to check out our step-by-step SDK setup videos on our <a href="https://www.youtube.com/channel/UCLo7viliyZV7p_GxOZf_MMw/playlists">Youtube channel</a></p>
<h2 id="prerequisites">Prerequisites:</h2>
<ul>
<li>
<p>PlayFab SDK must be installed prior to module installation <a href="https://api.playfab.com/sdks/unity">(download)</a>.</p>
</li>
<li>
<p>Playfab Title</p>
</li>
</ul>
<h2 id="installation">Installation:</h2>
<ol>
<li>Import content of <code>QuartersSDK/Modules/PlayFab/PlayFabModule.unitypackage</code> to your project</li>
<li>Add <code>QUARTERS_MODULE_PLAYFAB</code> scripting define in Player Settings. If you are supporting more
    than one platform add <code>QUARTERS_MODULE_PLAYFAB</code> scripting define to each platform tab in Player Settings</li>
<li>Open <code>QuartersSDK/Modules/PlayFab/QuartersPlayFabModuleServer.txt</code>,
    copy <code>SERVER_TOKEN</code> for your Quarters App,
    copy <code>APP_ADDRESS</code> for your Quarters App (found in <code>Quarters app settings/Edit app</code>)</li>
</ol>
<p>Example:</p>
<div class="codehilite"><pre><span></span>var SERVER_TOKEN = &quot;xk9q9fdxhbu65lyplqhwqe29klduvtoj9izi0g4wgrdy56b1dd32&quot;;
var APP_ADDRESS = &quot;0x1e2aa0184dcde9502568593d6c5da68966a32712&quot;;
</pre></div>


<ol>
<li>Add whatever custom logic you require using JavaScript in QuartersPlayFabModuleServer.txt in the marked section.</li>
</ol>
<div class="codehilite"><pre><span></span> /*
    ######## ENTER YOUR CUSTOM LOGIC HERE,
    BY DEFAULT EVERY AWARD REQUEST IS ACCEPTED
*/
</pre></div>


<p>This step is critical, custom logic MUST be used. Otherwise any client side request will transfer Quarters out from the Quarters app.</p>
<ol>
<li>Copy content of QuartersPlayFabModuleServer.txt to your existing Playfab Cloud Script. If you don't have any existing Cloud Script code you can simply
    upload QuartersPlayFabModuleServer.txt stright to Automation section in PlayFab console.</li>
</ol>
<h2 id="awardquarters">AwardQuarters</h2>
<p>Award quarters server call allows transferring quarters from Quarters app to user. It can be called from client side through the cloud script handler as well as directly from another Cloud Script function when
Quarters should be awarded to the user.</p>
<p>Example 1:</p>
<p>In this example user requests 2 quarters to be awarded to him. Typical "real life" example would be daily reward for login in to the game.
Call is made from the client side to cloud script server. During the AwardQuarters call cloud script checks when last time reward was given to the user.
Authorization is for this transaction is granted or declined by Cloud Script.</p>
<p><strong><em># Client Side</em></strong></p>
<div class="codehilite"><pre><span></span><span class="nt">using</span> <span class="nt">QuartersSDK</span><span class="o">;</span>
<span class="nt">using</span> <span class="nt">PlayFab</span><span class="o">;</span>
<span class="nt">using</span> <span class="nt">PlayFab</span><span class="p">.</span><span class="nc">ClientModels</span><span class="o">;</span>


<span class="o">//</span><span class="nt">login</span> <span class="nt">user</span> <span class="nt">to</span> <span class="nt">playfab</span> <span class="nt">title</span> <span class="nt">using</span> <span class="nt">device</span> <span class="nt">id</span>
<span class="nt">LoginWithCustomIDRequest</span> <span class="nt">loginRequest</span> <span class="o">=</span> <span class="nt">new</span> <span class="nt">LoginWithCustomIDRequest</span><span class="o">();</span>
<span class="nt">loginRequest</span><span class="p">.</span><span class="nc">CustomId</span> <span class="o">=</span> <span class="nt">SystemInfo</span><span class="p">.</span><span class="nc">deviceUniqueIdentifier</span><span class="o">;</span>
<span class="nt">loginRequest</span><span class="p">.</span><span class="nc">CreateAccount</span> <span class="o">=</span> <span class="nt">true</span><span class="o">;</span>


<span class="nt">PlayFabClientAPI</span><span class="p">.</span><span class="nc">LoginWithCustomID</span><span class="o">(</span><span class="nt">loginRequest</span><span class="o">,</span> <span class="nt">delegate</span><span class="o">(</span><span class="nt">LoginResult</span> <span class="nt">result</span><span class="o">)</span> <span class="p">{</span>

    <span class="err">Debug.Log(&quot;Playfab</span> <span class="err">user</span> <span class="err">logged</span> <span class="n">in</span><span class="p">:</span> <span class="s2">&quot; + result.PlayFabId);</span>

<span class="s2">    //Request 2 quarters from Playfab Cloud build</span>
<span class="s2">    Quarters.Instance.AwardQuarters(2, delegate(string transactionHash) {</span>

<span class="s2">        Debug.Log(&quot;</span><span class="n">Quarters</span> <span class="n">awarded</span><span class="o">:</span> <span class="err">&quot;</span> <span class="o">+</span> <span class="n">transactionHash</span><span class="p">);</span>


    <span class="p">}</span><span class="o">,</span> <span class="nt">delegate</span> <span class="o">(</span><span class="nt">string</span> <span class="nt">error</span><span class="o">)</span> <span class="p">{</span>

        <span class="err">Debug.LogError(error)</span><span class="p">;</span>

    <span class="p">}</span><span class="o">);</span>

<span class="err">}</span><span class="o">,</span> <span class="nt">delegate</span> <span class="o">(</span><span class="nt">PlayFabError</span> <span class="nt">error</span><span class="o">)</span><span class="p">{</span>
    <span class="err">Debug.LogError(error.ErrorMessage)</span><span class="p">;</span>
<span class="p">}</span><span class="o">);</span>
</pre></div>


<hr />
<p><strong><em># Cloud Script Side</em></strong></p>
<div class="codehilite"><pre><span></span><span class="kd">var</span> <span class="nx">TRANSFER_URL</span> <span class="o">=</span> <span class="s2">&quot;https://api.pocketfulofquarters.com&quot;</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">SERVER_TOKEN</span> <span class="o">=</span> <span class="s2">&quot;xk9q9fdxhbu65lyplqhwqe29klduvtoj9izi0g4wgrdy56b1ddle21&quot;</span><span class="p">;</span> <span class="c1">//ENTER SERVER TOKEN HERE</span>
<span class="kd">var</span> <span class="nx">APP_ADDRESS</span> <span class="o">=</span> <span class="s2">&quot;0x1e2aa0184dcde9502568593d6c5da68966a3275adasda&quot;</span><span class="p">;</span> <span class="c1">//ENTER APP ADDRESS HERE</span>


<span class="c1">//PlayFab Cloud script handler</span>
<span class="nx">handlers</span><span class="p">.</span><span class="nx">AwardQuarters</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">args</span><span class="p">,</span> <span class="nx">context</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">AwardQuarters</span><span class="p">(</span><span class="nx">args</span><span class="p">);</span>
    <span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
<span class="p">};</span>



<span class="kd">function</span> <span class="nx">AwardQuarters</span> <span class="p">(</span><span class="nx">args</span><span class="p">)</span> <span class="p">{</span>

    <span class="kd">var</span> <span class="nx">amount</span> <span class="o">=</span> <span class="nx">args</span><span class="p">[</span><span class="s2">&quot;amount&quot;</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">user</span> <span class="o">=</span> <span class="nx">args</span><span class="p">[</span><span class="s2">&quot;userId&quot;</span><span class="p">];</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">SERVER_TOKEN</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">log</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot;Missing SERVER_TOKEN parameter&quot;</span><span class="p">);</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">APP_ADDRESS</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">log</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot;Missing APP_ADDRESS parameter&quot;</span><span class="p">);</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">amount</span> <span class="o">==</span> <span class="kc">undefined</span> <span class="o">||</span> <span class="nx">amount</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">log</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot;Missing amount parameter&quot;</span><span class="p">);</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">user</span> <span class="o">==</span> <span class="kc">undefined</span> <span class="o">||</span> <span class="nx">user</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">log</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot;Missing user parameter&quot;</span><span class="p">);</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">log</span><span class="p">.</span><span class="nx">info</span><span class="p">(</span><span class="s2">&quot;Award &quot;</span> <span class="o">+</span> <span class="nx">amount</span> <span class="o">+</span> <span class="s2">&quot; quarters to user: &quot;</span> <span class="o">+</span> <span class="nx">user</span><span class="p">);</span>


    <span class="kd">var</span> <span class="nx">requestAuthorized</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>

    <span class="cm">/*</span>
<span class="cm">       ######## ENTER YOUR CUSTOM LOGIC HERE,</span>
<span class="cm">       BY DEFAULT EVERY AWARD REQUEST IS ACCEPTED</span>


<span class="cm">       var shouldReceiveDailyBonus = !DidReceivedBonusToday(userId); //DidReceivedBonusToday could be a custom logic method checking Playfab user data</span>

<span class="cm">       if (shouldReceiveDailyBonus == false) {</span>
<span class="cm">           log.error(&quot;Daily bonus already given today&quot;);</span>
<span class="cm">           requestAuthorized = false;</span>
<span class="cm">       }</span>

<span class="cm">       if (amount != DAILY_BONUS_AMOUNT) {</span>
<span class="cm">           log.error(&quot;Requested daily bonus amount is incorrect&quot;);</span>
<span class="cm">           requestAuthorized = false;</span>
<span class="cm">       }</span>


<span class="cm">    */</span>


    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">requestAuthorized</span><span class="p">)</span> <span class="k">return</span> <span class="p">{</span> <span class="nx">error</span><span class="o">:</span> <span class="s2">&quot;Award Quarters request not authorized by game server&quot;</span> <span class="p">};</span>

    <span class="kd">var</span> <span class="nx">postData</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;amount&quot;</span><span class="o">:</span> <span class="nx">amount</span><span class="p">,</span>
        <span class="s2">&quot;user&quot;</span><span class="o">:</span> <span class="nx">user</span>
    <span class="p">};</span>

    <span class="kd">var</span> <span class="nx">url</span> <span class="o">=</span> <span class="nx">TRANSFER_URL</span> <span class="o">+</span> <span class="s2">&quot;/v1/accounts/&quot;</span> <span class="o">+</span> <span class="nx">APP_ADDRESS</span> <span class="o">+</span> <span class="s2">&quot;/transfer&quot;</span><span class="p">;</span>

    <span class="kd">var</span> <span class="nx">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;Authorization&#39;</span><span class="o">:</span> <span class="s1">&#39;Bearer &#39;</span> <span class="o">+</span> <span class="nx">SERVER_TOKEN</span><span class="p">,</span>
        <span class="s1">&#39;Content-Type&#39;</span><span class="o">:</span> <span class="s1">&#39;application/json;charset=UTF-8&#39;</span>
    <span class="p">};</span>

    <span class="kd">var</span> <span class="nx">contentType</span> <span class="o">=</span> <span class="s2">&quot;application/json&quot;</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">contentBody</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">postData</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">response</span> <span class="o">=</span> <span class="nx">http</span><span class="p">.</span><span class="nx">request</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span> <span class="s2">&quot;post&quot;</span><span class="p">,</span> <span class="nx">contentBody</span><span class="p">,</span> <span class="nx">contentType</span><span class="p">,</span> <span class="nx">headers</span><span class="p">);</span>

    <span class="k">return</span> <span class="nx">response</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../unity/" title="Unity" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Unity
              </span>
            </div>
          </a>
        
        
          <a href="../unity-playfab-iap/" title="Unity PlayFab IAP" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Unity PlayFab IAP
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.2ba8dec4.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script>
      
    
  </body>
</html>